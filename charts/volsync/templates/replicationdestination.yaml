---
# yaml-language-server: $schema=https://k8s-schemas.bjw-s.dev/volsync.backube/replicationdestination_v1alpha1.json
apiVersion: volsync.backube/v1alpha1
kind: ReplicationDestination
metadata:
  name: {{ include "volsync.bootstrap" $}}
spec:
  trigger:
    manual: restore-once
  restic:
    repository: {{ include "volsync.restic.secret" $ }}
    destinationPVC: {{ include "volsync.name" $ }}
    copyMethod: Snapshot
    cleanupCachePVC: true
    cleanupTempPVC: true
    enableFileDeletion: true
    moverSecurityContext:
      runAsUser: {{ .Values.volsync.moverSecurityContext.runAsUser }}
      runAsGroup: {{ .Values.volsync.moverSecurityContext.runAsGroup }}
      fsGroup: {{ .Values.volsync.moverSecurityContext.fsGroup }}

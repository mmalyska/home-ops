- name: Install packages
  ansible.builtin.include_tasks: packages.yml
  tags:
    - apt

- name: Check for containerd configuration file
  ansible.builtin.stat:
    path: /etc/containerd/config.toml
  register: containerd_config_register
  tags:
    - checks
    - containerd

- name: Configure containerd
  ansible.builtin.include_tasks: configure.yml
  tags:
    - containerd
  when: not containerd_config_register.stat.exists
